- defaults:
    link:
      relink: true
      create: true
    shell:
      stderr: true

- clean: ['~']

- link:
    ~/.dotfiles: ""

- create:
    ~/.dotfiles/backup:
      mode: 0775

- shell:
  - 
    command: bash -c 'if [[ -f ~/.profile ]] && [[ ! -L ~/.profile ]]; then mv ~/.profile ~/.dotfiles/backup/; fi'
    description: Backup .profile file
  - 
    command: bash -c 'if [[ -f ~/.config/pip/pip.conf ]] && [[ ! -L ~/.config/pip/pip.conf ]]; then mv ~/.config/pip/pip.conf ~/.dotfiles/backup/pip.conf; fi'
    description: Backup pip.conf file
  - 
    command: bash -c 'if [[ -f ~/.config/git/config ]] && [[ ! -L ~/.config/git/config ]]; then mv ~/.config/git/config ~/.dotfiles/backup/.gitconfig; fi'
    description: Backup .gitconfig file
  - 
    command: bash -c 'if [[ -f ~/.bashrc ]] && [[ ! -L ~/.bashrc ]]; then mv ~/.bashrc ~/.dotfiles/backup/; fi'
    description: Backup .bashrc file

- link:
    ~/.condarc: .condarc
    ~/.config/fish/config.fish: .config/fish/config.fish
    ~/.config/git/config: .config/git/config
    ~/.config/pip/pip.conf: .config/pip/pip.conf
    ~/.config/uv/uv.toml: .config/uv/uv.toml
    ~/.bashrc: .bashrc
    ~/.gdbinit: .gdbinit
    ~/.inputrc: .inputrc
    ~/.profile: .profile
    ~/.tmux.conf: .tmux.conf
    ~/.vim: .vim
    ~/.vimrc: .vimrc
    ~/.wakatime.cfg: .wakatime.cfg
    ~/.xmodmap: .xmodmap

- shell:
  - [git submodule update --init --recursive, Installing submodules]
  - 
    command: sudo ./install -p dotbot-apt/apt.py -c configs/apt.conf.yaml
    description: Install apt packages
    stdout: true
  - [bash -c 'sudo chsh -s $(which fish) $(whoami)', Making fish the default shell]
