- defaults:
    link:
      relink: true
      create: true
    shell:
      stderr: true

- clean: ['~']

- link:
    ~/.dotfiles: ""

- create:
    ~/.dotfiles/backup:
      mode: 0775

- shell:
  - 
    command: bash -c 'if [[ -f ~/.profile ]] && [[ ! -L ~/.profile ]]; then mv ~/.profile ~/.dotfiles/backup/; fi'
    description: Backup .profile file

- link:
    ~/.condarc: .condarc
    ~/.config/fish/config.fish: .config/fish/config.fish
    ~/.gdbinit: .gdbinit
    ~/.gitconfig: .gitconfig
    ~/.inputrc: .inputrc
    ~/.pip: .pip
    ~/.profile: .profile
    ~/.tmux.conf: .tmux.conf
    ~/.vim: .vim
    ~/.vimrc: .vimrc
    ~/.wakatime.cfg: .wakatime.cfg
    ~/.xmodmap: .xmodmap

- shell:
  - [git submodule update --init --recursive, Installing submodules]
  -
    command: sudo ./install -p dotbot-apt/apt.py -c apt.conf.yaml
    description: Install apt packages
    stdout: true
  - [bash -c 'sudo chsh -s $(which fish) $(whoami)', Making fish the default shell]
  - [bash -c 'curl -LO https://go.dev/dl/go1.22.4.linux-amd64.tar.gz', download go for mig-parted]
  - [bash -c 'sudo rm -rf /usr/local/go && sudo tar -C /usr/local -xzf go1.22.4.linux-amd64.tar.gz']
  - [bash -c '/usr/local/go/bin/go env -w GO111MODULE=on']
  -
    command: bash -c '/usr/local/go/bin/go env -w GOPROXY=https://goproxy.cn,direct'
    description: go init
  - [bash -c '/usr/local/go/bin/go install github.com/NVIDIA/mig-parted/cmd/nvidia-mig-parted@latest', install mig-parted]
